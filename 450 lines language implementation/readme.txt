https://jsfiddle.net/i_e_b/kg420tqr/

450 lines language implementation

Note that 150 of these lines are blank or comments, so it's actually more like 300 lines.